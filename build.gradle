apply plugin: 'java'
apply plugin: 'eclipse'

buildscript {
    repositories {
        flatDir dirs: "$projectDir/proguard_libs"
    }
    dependencies {
        classpath ':proguard:'
    }
}

repositories {
  mavenCentral()
}
dependencies{
  compile group: 'org.springframework', name: 'spring-context', version: '5.0.7.RELEASE'
}

task exportLibs(type: Copy) {
  into "$buildDir/dependencies"
  from configurations.runtime
}

task obfuscate(type: proguard.gradle.ProGuardTask) {
    configuration "$projectDir/proguard.conf"
    injars "$buildDir/libs/proguard-keep-annotations.jar"
    outjars "$buildDir/libs/proguard-keep-annotations-obfuscated.jar"
}

task run(type: JavaExec) {
   classpath = files('build/libs/proguard-keep-annotations-obfuscated.jar') + sourceSets.main.runtimeClasspath
   main = 'com.github.benji.proguard.TestClassHasAnnotation'
}